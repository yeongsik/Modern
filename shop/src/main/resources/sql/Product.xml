<?xml version="1.0" encoding="UTF-8" ?>
 <!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Productns">
	<!-- 상품목록 -->
	<!-- top -->
	<select id="productlist" parameterType="shop.model.ProductBean" resultType="shop.model.ProductBean">
  	 	<![CDATA[
      		  select * from 
            (select rownum rnum,p.* from 
            (select * from product left outer join product_detail on product.product_detail = product_detail.product_detail
             where category_id = #{category_id} order by product_date desc) p) 
             where rnum >= ((#{page}-1) * 9+1) and rnum <= (#{page}*9)
        ]]>
	</select>
	
    <!-- 상품 총 갯수 -->
    <select id ="productcount" parameterType="product" resultType="int">
    	select count(distinct product_name) from product where category_id = #{category_id}
    </select>
    
    <select id="product_detail" parameterType="int" resultType="product">
    	select * from product left outer join product_detail 
    	on product.product_detail = product_detail.product_detail where product_id = #{product_id}
    </select>


    
    <!-- 상품 사이즈 데이터 가져오기 -->
    <select id="getSize" parameterType="String" resultType="size_table">
    	select * from size_table where size_id = #{size_id}
    </select>
  	<!-- 상품 조회수 증가 -->
  	<update id="upViewCount" parameterType="int">
    	update product set view_count = view_count +1 where product_id = #{product_id} 
    </update> 
    
    
<!--     상품 이름 가져오기
    <select id="product_name" parameterType="" resultType="product">
    	select product_name from product p inner join question q on p.product_id = q.product_id
    </select> -->
    
</mapper>